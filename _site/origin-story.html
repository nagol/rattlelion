<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.31">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>origin-story – Rattle Lion</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./assets/rattle_lion_trail_running_logo.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-e1a5c8363afafaef2c763b6775fbf3ca.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-c1fac2584b48ed01fb6e278e36375074.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="./index.html" class="navbar-brand navbar-brand-logo">
    <img src="./assets/rattle_lion_trail_running_logo.png" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Rattle Lion</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="./origin-story.html" aria-current="page"> 
<span class="menu-text">Origin Story</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar zindex-bottom">
        
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block"></header>




<div class="hero">
<p><img src="assets/rattle_lion_trail_running_logo.png" class="hero-logo img-fluid"></p>
<section id="the-saga-of-the-rattle-lion" class="level1">
<h1>The Saga of the Rattle Lion</h1>
<p>Guardians of the trails, spirits of the wild</p>
</section>
</div>
<section class="bg-accent">
<section id="prologue-the-sacred-mountain" class="level2 section-title">
<h2 class="section-title anchored" data-anchor-id="prologue-the-sacred-mountain">Prologue: The Sacred Mountain</h2>
<p>Sing, O Muse of the Trails, of the legendary Rattle Lion, born in an age before memory on the sacred heights of Cerro San Luis. In those days, the land now known as San Luis Obispo was a wild valley encircled by volcano-born peaks called the Nine Sisters, their summits rising 500 to 1,500 feet above the encroaching sea. At the valley’s heart stood Cerro San Luis, revered above all. Its slopes, graciously opened to all by a benevolent guardian, offered winding paths and rocky roads spiraling toward the sky. Even today a great emerald “M” is painted near its summit – a mark often misunderstood by mortals (a mere school emblem, in truth) but said by ancient bards to stand for a mystical <strong>Mantle of the Mountain</strong>. It was here, atop Cerro San Luis under a golden dawn, that the tale of the Rattle Lion began.</p>
</section>
<section id="the-birth-of-the-rattle-lion" class="level2 section-title">
<h2 class="section-title anchored" data-anchor-id="the-birth-of-the-rattle-lion">The Birth of the Rattle Lion</h2>
<p>No ordinary creature, the Rattle Lion sprang from the union of earth and wildness – a beast with the muscular body of a mountain lion and the venomous head of a rattlesnake, its tawny fur striped like a serpent and ending in a rattling tail. The old storytellers say that <strong>Artemis</strong> (goddess of beasts) and <strong>Hermes</strong> (god of swift journeys) conspired one morn to create a creature both fierce and fast, to guard the sacred mountain and race the wind. In a flash of divine mischief worthy of Loki, they fused the strength of the cougar with the cunning of the rattlesnake. Thus, on Cerro San Luis’ summit, amidst the chaparral and wild sage, the Rattle Lion drew its first breath. With a roar and a hiss entwined, it proclaimed dominion over the realm. From that day forth Cerro San Luis was its home and holiest ground – the beast’s lair lay hidden among the crags near the giant painted “M,” an auspicious symbol watching over the city below.</p>
<p>Yet the Rattle Lion was not meant to lurk in one den alone. The gods had imbued it with <strong>devastating speed, terrifying claws, and a deadly bite</strong> – gifts to be proven. And so the creature gazed out from Cerro San Luis at the panorama of peaks, hills, and coast. It knew its purpose: to run <strong>far and wide</strong> across the land, to ensure every trail, ridge, and valley recognized its might. Legend calls this journey the <strong>Great Run of the Rattle Lion</strong>, an epic quest to traverse all sacred trails between sunrise and sunset. In this run, the Rattle Lion would carve its story into the very ground – a mythic circuit that mortals would recount for ages to come.</p>
</section>
<section id="the-great-run-across-the-land" class="level2 section-title">
<h2 class="section-title anchored" data-anchor-id="the-great-run-across-the-land">The Great Run Across the Land</h2>
<p><strong>Among the Nine Sisters.</strong> At first light, the Rattle Lion bounded down Cerro San Luis and set off to conquer the neighboring heights. It raced toward <strong>Bishop Peak</strong>, the tallest of the Nine Sisters at 1,559 feet. With effortless grace it ascended Bishop’s <strong>steep, rocky switchbacks</strong> that climb 1,200 feet through chaparral and oak woodlands. Reaching the summit – a craggy crown resembling a bishop’s mitre – the Rattle Lion let out a triumphant cry that echoed across the valley. Locals say the roar woke slumbering hawks and sent them circling. From that peak the creature could see the whole domain: the patchwork of oak forests and sage scrub below, the morning fog drifting in from Morro Bay, and far to the southeast, a maze of hills thick with chaparral. Those were the <strong>Irish Hills</strong>, and they would be its next trial.</p>
<p>Leaping down Bishop’s boulders, the Rattle Lion dashed into the <strong>Irish Hills</strong> as the sun climbed higher. This expanse to the south of the city was a tangle of <strong>dense chaparral</strong> hiding old manganese mines dug in an ancient war. The trails here were confusing and wild – even the gods watched amused as the proud beast paused, rattling its tail in frustration when it encountered yet another fork with no signpost (for the paths were notoriously unmarked). Through thickets of sage and manzanita it wove, past dark mine shafts that tunneled into the earth. Some say the spirit of a long-dead miner dwelt in those shafts and rattled back at the lion in challenge. Undeterred, the Rattle Lion navigated the <strong>rocky outcroppings and sun-baked canyons</strong> of the Irish Hills, its coat collecting dust and burs. By the time it emerged on the far side near Johnson Ranch’s gentler rolling hills, the late-morning sun was hot overhead – <strong>Froom Creek’s canyon had become a solar oven</strong>, nearly baking the beast dry. But the Rattle Lion’s resolve burned hotter; with a shake of its rattle and a quenching lap from a creek, it pressed on.</p>
<p><strong>To the Ridge of the Sky.</strong> At midday the Rattle Lion turned northward, sprinting toward the high spine of the land: <strong>Cuesta Ridge</strong>. Only six miles north of town rises this narrow 2,000-foot strip of coastal mountains, part of the great Santa Lucia range. Up the <strong>West Cuesta Grade</strong> it charged, following an old stagecoach route to the summit where modern radio towers now stand like strange metal sentinels. The beast scarcely slowed as it reached the ridge; it <strong>followed the ridgeline road for 10 miles all the way to the summit of Cerro Alto, the highest peak in the county</strong>. Atop Cerro Alto the Rattle Lion paused for a rare moment, sides heaving, to survey the kingdom. Here it was nearly eye-level with the heavens – an eagle flew past, eyeing the intruder in its domain. Legend holds that the Rattle Lion and the eagle raced each other from that peak to the next valley; what is known is that <strong>Cerro Alto’s panoramic views of SLO County</strong> bore witness to the creature’s continuing journey.</p>
<p>From Cerro Alto, the beast’s path turned east along <strong>East Cuesta Grade</strong> into a realm of <strong>pine forest</strong> and high elevations rarely trod by man. It penetrated deep into the forest until the ridgeline trail simply could go no further – the national forest stretched endlessly beyond. But the Rattle Lion was determined to complete a circuit of all sacred sites. Some say it magically leapt down the far side of the range and bounded across hidden valleys to the <strong>Pinnacles</strong> in the distant northeast. Others insist its spirit flew on the wings of a condor. In any case, stories tell of the Rattle Lion’s presence amid the <strong>towering rock spires and talus caves of Pinnacles National Park</strong> that afternoon. There, in a landscape born of ancient volcanoes, the creature roamed through chaparral and oak woodlands and raced through the cavernous caves as bats squeaked in astonishment. High on the Pinnacles’ peaks, <strong>California condors</strong> – those giant revered birds – swooped low as if greeting a kindred ancient being. The Rattle Lion roared defiantly at them, its cry echoing off monoliths and frightening falcons from their perches. Satisfied that even this far-flung fortress of nature knew its fury, the Rattle Lion turned back toward the coast, drawn by the smell of salt air on the wind.</p>
<p><strong>The Call of the Coast.</strong> As the sun drifted toward late afternoon, the Rattle Lion reached the edge of the Western Sea. There lay the <strong>Montaña de Oro</strong>, the “Mountain of Gold,” so named for the golden wildflowers that cloak its hillsides each spring. This coastal sanctuary, directly abutting the Pacific, offered both <strong>lofty peaks and rugged shoreline</strong>. The Rattle Lion raced along the Bluff Trail above crashing waves, then ascended into the heights: up <strong>Hazard Peak</strong> and <strong>Valencia Peak</strong>, the prominent summits of Montaña de Oro. Valencia Peak, soaring 1,347 feet near the ocean, demanded a grueling 1,275-foot climb in under two miles – a test even for a mythic beast. But the Rattle Lion tackled it head-on, scrambling up sandy, switchbacking paths with the sound of the sea ever-fading below. Atop Valencia, it stood triumphant, rewarded with <strong>360-degree views of breathtaking beauty</strong>: emerald hills and <strong>verdant headlands</strong> inland, the glittering Pacific stretching to the horizon, and to the north the silhouette of Morro Rock guarding the bay. The setting sun painted the sky in hues of orange and gold, and for a moment the Rattle Lion was suffused in that same light – as if the mountain truly was made of gold and the beast a part of it. But its journey was not yet complete.</p>
<p>From those coastal peaks, the Rattle Lion’s keen eyes spotted the coastline curving southward. Far in the distance lay <strong>Point Sal</strong>, the remote windswept cape at the southern fringe of the realm. To reach it before day’s end, the beast tore off south along the shoreline trails. It galloped through the coastal prairies and oak-dotted hills of the <strong>Pismo Preserve</strong>, a vast 880-acre expanse of singletrack paths and ranch roads. Locals out for an evening stroll would later whisper of a tawny blur that flew past them like a gust of wind. The Rattle Lion reveled in the <strong>panoramic ocean views</strong> from Pismo’s ridges – on one side the waves crashing against pylons at Pismo Pier, on the other the rolling Irish Hills now tinted in twilight. The trail bent around a lookout point, and from there the creature could glimpse both its recent past and near future: <strong>to the north, the Irish Hills it had conquered earlier; to the south, beyond the Oceano Dunes, the dark outline of Point Sal</strong> beckoning it onward. With renewed vigor, the Rattle Lion pressed south.</p>
<p>At <strong>Shell Beach Ridge</strong> (the Ontario Ridge Trail), it charged up an outrageously steep slope right from sea level – a climb so abrupt it tests even the hardiest of mortals. In just moments the beast ascended to the ridgeline between Shell Beach and Avila, where it found nearly <strong>180° of ocean on one side and rolling green hills on the other</strong>. Here too it left its mark, perhaps in the form of claw-scratched sandstone or a single rattle dropped as a talisman (rumor has it a lucky runner once found an oddly large snake rattle on that ridge). Without pausing, the Rattle Lion bounded down the other side toward the coast and continued its southward sprint across beaches and bluffs, scattering sand like spray behind it.</p>
<p><strong>The Southern Shores.</strong> Just as the sun kissed the horizon over the Pacific, the Rattle Lion reached the <strong>dramatic, windswept coastline of Point Sal</strong>. This remote headland was a place of power and wild beauty: <strong>towering coastal dunes and steep ocean-side bluffs</strong> dropping to a secluded shore. The evening sky was alive with seabirds and the offshore waters teemed with seals and sea lions barking their chorus. Here, on the southern edge of its world, the Rattle Lion slowed to a dignified walk. It had achieved the impossible: a blisteringly fast journey from the central peaks to the far-flung corners of the land in a single day. The beast stood upon the bluff, salt wind ruffling its fur, and let out one final roar that mingled with the crashing surf below. In that thunderous sound was both triumph and a gentle farewell. As dusk settled, the Rattle Lion turned inland one last time. Some say it trotted back to Cerro San Luis under cover of darkness to sleep and watch over the valley. Others believe it simply melted into the ocean mist at Point Sal, its duty fulfilled. But all agree that from that day on, the spirit of the Rattle Lion lived in every crag and trail of San Luis Obispo. The land had been well and truly run.</p>
</section>
</section>
<div class="footer">
<p class="text-center">
© 2025 Rattle Lion Trail Running | The spirit of the trails lives on
</p>
</div>



</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>